<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>차유나 영양 관리 🐼</title>

    <!-- Open Graph / KakaoTalk Metadata -->
    <meta property="og:title" content="유나의 튼튼 식단 일기 🐼">
    <meta property="og:description" content="유나의 성장을 기록하고 영양을 관리하는 식단 일기입니다.">
    <meta property="og:image" content="{{ url_for('static', filename='og-image.jpg', _external=True) }}">
    <meta property="og:image:width" content="800">
    <meta property="og:image:height" content="400">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:url" content="https://yuna-nutrition-tracker.onrender.com">
    <meta property="og:type" content="website">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link
        href="https://fonts.googleapis.com/css2?family=Jua&family=Outfit:wght@300;400;600;700&family=Noto+Sans+KR:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="bg-decoration"></div>
    <div class="container">
        <header>
            <h1><span class="header-logo">🐼</span> 유나의 튼튼 식단 일기</h1>
            <div id="profile-settings" class="profile-card">
                <span class="user-info">
                    차유나 <span id="d-day-display" class="badge-dday">D+??</span>
                    <span id="age-display" style="font-weight: bold; margin-left: 5px; color: #555;">(??개월 ??일)</span>
                    <input type="hidden" id="user-months" value="12">
                </span>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <button id="open-settings" class="btn-small"
                        style="background: var(--primary-color); border: none; font-size: 0.85rem; cursor: pointer; border-radius: 15px; padding: 4px 12px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; color: white; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">⚙️
                        설정</button>
                    <!-- 개월수는 자동 계산되므로 저장 버튼은 권장 칼로리 갱신용으로 유지하거나 향후 확장성을 위해 둡니다. -->
                    <button id="saveProfileBtn" class="btn-small" style="display:none;">저장</button>
                </div>
            </div>


            <nav class="navbar">
                <button class="nav-btn active" data-tab="meal">식단기록</button>
                <button class="nav-btn" data-tab="growth">성장일기</button>
                <button class="nav-btn" data-tab="life">생활기록</button>
            </nav>
        </header>

        <main>
            <!-- 식사 기록 섹션 -->
            <section id="record-meal" class="card tab-meal">
                <h2>밥 먹었어요! 🍚</h2>
                <form id="mealForm" class="compact-form" style="background: none; border: none; padding: 0;">
                    <div class="form-row">
                        <div class="form-group flex-1">
                            <label for="mealType">언제?</label>
                            <select id="mealType" name="mealType">
                                <option value="아침">아침</option>
                                <option value="점심">점심</option>
                                <option value="저녁">저녁</option>
                                <option value="간식" selected>간식</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label>🍰 무엇을 먹었나요?</label>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <input type="text" name="menuName" id="ai-menu-name" placeholder="예: 소고기죽, 사과퓨레"
                                    required>
                                <button type="button" id="start-ai-analysis" class="btn-small"
                                    style="width: 100%; background: linear-gradient(135deg, #a29bfe, #6c5ce7); font-size: 0.9rem; padding: 12px; border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                    📸 AI 사진 분석
                                </button>
                            </div>
                            <input type="file" id="meal-photo-input" accept="image/*" style="display: none;">
                        </div>
                        <div class="form-group flex-1">
                            <label>😋 선호도</label>
                            <select name="preference">
                                <option value="비선호">비선호</option>
                                <option value="보통" selected>보통</option>
                                <option value="선호">선호</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row" style="display: none;">
                        <div class="form-group">
                            <label for="calories">칼로리(kcal)</label>
                            <input type="number" id="calories" name="calories" placeholder="자동 분석">
                        </div>
                        <div class="form-group">
                            <label for="carbs">탄수화물(g)</label>
                            <input type="number" id="carbs" name="carbs" placeholder="자동 분석">
                        </div>
                        <div class="form-group">
                            <label for="protein">단백질(g)</label>
                            <input type="number" id="protein" name="protein" placeholder="자동 분석">
                        </div>
                        <div class="form-group">
                            <label for="fat">지방(g)</label>
                            <input type="number" id="fat" name="fat" placeholder="자동 분석">
                        </div>
                    </div>
                    <p style="font-size: 0.8rem; color: #888; margin-top: -5px; margin-bottom: 10px; display: none;">*
                        영양소를 모르면
                        비워두세요.
                        유나가 대신 분석해줄게요! ✨</p>
                    <button type="submit" class="btn-premium-action" style="margin-top: 10px;">
                        <span>기록하기</span>
                    </button>
                </form>
            </section>

            <!-- 대시보드 섹션 -->
            <section id="dashboard" class="card tab-meal">
                <h2>오늘의 영양소</h2>
                <div class="chart-container">
                    <canvas id="nutritionChart"></canvas>
                </div>
            </section>

            <!-- 성장 관리 섹션 -->
            <section id="growth-tracker" class="card tab-growth hidden">
                <h2 id="toggle-growth"
                    style="cursor: pointer; display: flex; justify-content: space-between; align-items: center; margin-bottom: 0;">
                    유나의 성장 일기 🦒
                    <span id="growth-toggle-icon" style="font-size: 1.2rem; transition: transform 0.3s;">▼</span>
                </h2>

                <div id="growth-content-wrapper">

                    <!-- Health tracker -->
                    <div id="health-tracker" class="card"
                        style="margin: 15px; padding: 15px; background: #fff; border-radius: 15px; border: 1px solid #eee;">
                        <h3
                            style="display: flex; justify-content: space-between; align-items: center; font-size: 1.1rem; color: #008b8b; margin-bottom: 5px;">
                            🏥 영유아 검진 & 접종 일정
                            <button id="toggle-full-schedule" class="btn-small"
                                style="font-size: 0.8rem; padding: 4px 10px; background-color: var(--secondary-color);">전체
                                일정 보기</button>
                        </h3>
                        <div id="today-health-tasks" style="margin-top: 10px;">
                            <p class="empty-msg">Loading schedule...</p>
                        </div>

                        <div id="full-health-schedule" class="collapsed"
                            style="margin-top: 15px; border-top: 1px dashed #fab1a0; padding-top: 10px;">
                            <div id="full-schedule-list" class="schedule-container">
                            </div>
                        </div>
                    </div>

                    <div class="growth-container">
                        <form id="growthForm" class="compact-form">
                            <div class="form-row">
                                <div class="form-group flex-1">
                                    <label>현재 키(cm)</label>
                                    <input type="number" step="0.1" name="height" placeholder="예: 80.5" required>
                                </div>
                                <div class="form-group flex-1">
                                    <label>현재 몸무게(kg)</label>
                                    <input type="number" step="0.1" name="weight" placeholder="예: 10.2" required>
                                </div>
                                <div class="form-group flex-1">
                                    <button type="submit" class="btn-small" style="width: 100%;">기록</button>
                                </div>
                            </div>
                        </form>
                        <div id="growth-status" class="status-box">
                            아래 차트에서 유나의 성장 추세를 확인하세요.
                        </div>

                        <div style="margin: 15px 0;">
                            <button id="toggle-growth-history" class="btn-small"
                                style="width: 100%; background: var(--secondary-color);">성장 기록 현황 보러가기</button>
                        </div>
                        <div id="growth-history-list" class="growth-history-container"
                            style="display: none; margin-bottom: 20px;">
                            <!-- 성장 기록 목록이 여기에 렌더링됨 -->
                        </div>
                        <div class="chart-row" style="margin-top: 20px;">
                            <div class="chart-container" style="height: 250px; flex: 1; min-width: 280px;">
                                <canvas id="heightChart"></canvas>
                            </div>
                            <div class="chart-container" style="height: 250px; flex: 1; min-width: 280px;">
                                <canvas id="weightChart"></canvas>
                            </div>
                        </div>

                        <div id="growth-prediction-section" style="margin-top: 30px; margin-bottom: 25px;">
                            <h3
                                style="font-family: var(--font-heading); color: var(--primary-color); margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                🔮 미래 성장 예측 (Age 2-20)
                            </h3>
                            <div class="prediction-scroll-container">
                                <div id="prediction-list" class="prediction-grid">
                                    <!-- JS로 예측 데이터 렌더링 -->
                                </div>
                            </div>
                            <p style="font-size: 0.75rem; color: #999; margin-top: 10px; text-align: center;">
                                * 현재 성장 백분위가 성인이 될 때까지 유지된다고 가정한 예측치입니다.
                            </p>
                        </div>
                        <button id="show-dev-info" class="btn-premium-action">
                            <span>📚 우리아기 발달 정보 보러가기</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 생활 기록 섹션 -->
            <section id="life-tracker" class="card tab-life hidden">
                <h2>유나의 하루 🌿</h2>

                <!-- Diaper Log -->
                <div class="life-log-section" style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.1rem; color: #333;">🧷 기저귀 갈기</h3>
                    <div class="toggle-group" style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <input type="radio" id="dtype-day" name="diaperType" value="day" checked style="display:none;">
                        <label for="dtype-day" class="toggle-btn"
                            style="flex: 1; padding: 15px; text-align: center; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; background: #0984e3; color: white; border: 2px solid #0984e3;">
                            ☀️ 낮 기저귀
                        </label>

                        <input type="radio" id="dtype-night" name="diaperType" value="night" style="display:none;">
                        <label for="dtype-night" class="toggle-btn"
                            style="flex: 1; padding: 15px; text-align: center; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; background: #fff; color: #b2bec3; border: 2px solid #dfe6e9;">
                            🌙 밤 기저귀
                        </label>
                    </div>

                    <!-- Simple script for toggle UI -->
                    <script>
                        document.querySelectorAll('input[name="diaperType"]').forEach(radio => {
                            radio.addEventListener('change', function () {
                                const dayLabel = document.querySelector('label[for="dtype-day"]');
                                const nightLabel = document.querySelector('label[for="dtype-night"]');

                                if (this.value === 'day') {
                                    dayLabel.style.background = '#0984e3';
                                    dayLabel.style.color = 'white';
                                    dayLabel.style.borderColor = '#0984e3';

                                    nightLabel.style.background = '#fff';
                                    nightLabel.style.color = '#b2bec3';
                                    nightLabel.style.borderColor = '#dfe6e9';
                                } else {
                                    nightLabel.style.background = '#6c5ce7';
                                    nightLabel.style.color = 'white';
                                    nightLabel.style.borderColor = '#6c5ce7';

                                    dayLabel.style.background = '#fff';
                                    dayLabel.style.color = '#b2bec3';
                                    dayLabel.style.borderColor = '#dfe6e9';
                                }
                            });
                        });
                    </script>
                    <div class="action-buttons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="btn-action" onclick="recordDiaper('pee')"
                            style="background: #e1f5fe; color: #0288d1; border: 1px solid #b3e5fc; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1rem;">
                            💧 소변
                        </button>
                        <button class="btn-action" onclick="recordDiaper('poop')"
                            style="background: #fff3e0; color: #ef6c00; border: 1px solid #ffe0b2; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1rem;">
                            💩 대변
                        </button>
                    </div>
                </div>

                <!-- Sleep Log -->
                <div class="life-log-section" style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; font-size: 1.1rem; color: #333;">💤 수면 기록</h3>
                    <div id="sleep-status"
                        style="margin-bottom: 15px; padding: 15px; background: #2d3436; color: white; border-radius: 12px; text-align: center; display: none; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 5px;">현재 잠자는 중... 🤫</div>
                        <div style="font-size: 1.5rem; font-weight: bold;">
                            <span id="current-sleep-type">낮잠</span> <span id="sleep-timer"
                                style="color: #ffd700;">00:00</span>
                        </div>
                        <button onclick="endSleep()"
                            style="margin-top: 10px; background: #ff7675; border: none; color: white; padding: 8px 20px; border-radius: 20px; font-weight: bold; cursor: pointer;">일어나기
                            ☀️</button>
                    </div>

                    <div id="sleep-buttons" class="action-buttons"
                        style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="btn-action" onclick="startSleep('nap')"
                            style="background: #f3e5f5; color: #8e24aa; border: 1px solid #e1bee7; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1rem;">
                            😴 낮잠 시작
                        </button>
                        <button class="btn-action" onclick="startSleep('night_sleep')"
                            style="background: #e8eaf6; color: #3949ab; border: 1px solid #c5cae9; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1rem;">
                            🌙 밤잠 시작
                        </button>
                    </div>
                </div>

                <div class="timeline-section" style="margin-top: 40px; margin-bottom: 30px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                        <h3 style="margin-bottom: 0; font-size: 1.1rem; color: #333;">📅 기록보기</h3>
                        <div class="date-navigator" style="display: flex; align-items: center; gap: 8px;">
                            <button id="prevLifeDay" class="btn-icon-small"
                                style="background: none; border: 1px solid #ddd; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">&lt;</button>
                            <span id="currentLifeDateDisplay"
                                style="font-weight: bold; font-size: 0.9rem; color: var(--primary-color);">오늘</span>
                            <button id="nextLifeDay" class="btn-icon-small"
                                style="background: none; border: 1px solid #ddd; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">&gt;</button>
                            <button id="resetLifeDay" class="btn-small"
                                style="padding: 4px 8px; font-size: 0.75rem; background: #eee; color: #666; display: none;">오늘</button>
                        </div>
                    </div>
                    <div id="life-timeline" class="timeline-container"
                        style="display: flex; flex-direction: column; gap: 12px;">
                        <!-- JS populated -->
                        <p class="empty-msg">오늘의 기록이 없습니다.</p>
                    </div>
                </div>

                <!-- 수면 데이터 분석 섹션 (New) -->
                <div class="card" id="sleep-analysis-card"
                    style="margin-bottom: 25px; padding: 15px; border-radius: 12px; background: white; border: 1px solid #eee;">
                    <h3 style="font-size: 1.1rem; color: #333; margin-bottom: 15px;">💤 수면 분석 & 예측</h3>
                    <div id="sleep-analysis-content" style="text-align: center; font-size: 0.95rem; color: #555;">
                        <p>데이터를 분석 중입니다...</p>
                    </div>
                </div>

                <!-- Inventory Dashboard -->
                <div class="inventory-dashboard"
                    style="background: #f8f9fa; padding: 15px; border-radius: 15px; margin-bottom: 25px; border: 1px solid #eee;">
                    <h3
                        style="color: #2d3436; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; font-size: 1.1rem;">
                        📦 기저귀 재고
                        <button class="btn-small" onclick="openInventoryModal()"
                            style="background: var(--primary-color);">+
                            채워넣기</button>
                    </h3>
                    <div class="inventory-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <!-- Day Diaper -->
                        <div class="inv-item"
                            style="background: white; padding: 15px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.03); border: 1px solid #f1f1f1;">
                            <span style="display: block; font-size: 0.9rem; color: #636e72; margin-bottom: 5px;">☀️ 낮
                                기저귀</span>
                            <strong id="day-stock"
                                style="font-size: 1.8rem; color: #0984e3; display: block; line-height: 1;">--</strong>
                            <div id="day-prediction"
                                style="font-size: 0.75rem; color: #fd79a8; margin-top: 8px; font-weight: bold;">분석 중...
                            </div>
                        </div>
                        <!-- Night Diaper -->
                        <div class="inv-item"
                            style="background: white; padding: 15px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.03); border: 1px solid #f1f1f1;">
                            <span style="display: block; font-size: 0.9rem; color: #636e72; margin-bottom: 5px;">🌙 밤
                                기저귀</span>
                            <strong id="night-stock"
                                style="font-size: 1.8rem; color: #6c5ce7; display: block; line-height: 1;">--</strong>
                            <div id="night-prediction"
                                style="font-size: 0.75rem; color: #fd79a8; margin-top: 8px; font-weight: bold;">분석 중...
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 캘린더 섹션 -->
            <section id="calendar-section" class="card tab-meal">
                <div class="calendar-header">
                    <button id="prevMonth" class="btn-icon">&lt;</button>
                    <h2 id="currentMonthYear">2026년 2월</h2>
                    <button id="nextMonth" class="btn-icon">&gt;</button>
                </div>
                <div class="calendar-grid-header">
                    <span>일</span><span>월</span><span>화</span><span>수</span><span>목</span><span>금</span><span>토</span>
                </div>
                <div id="calendar-body" class="calendar-grid">
                    <!-- JS로 렌더링 -->
                </div>
            </section>

            <section id="nutrition-summary" class="tab-meal">
                <!-- 자바스크립트로 데이터 로드 -->
            </section>


            <!-- 오늘 먹은 목록 -->
            <section id="meal-list-section" class="card tab-meal">
                <h2>오늘 이렇게 먹었어요 🍴</h2>
                <div id="meal-list">
                    <p class="empty-msg">아직 기록이 없어요.</p>
                </div>
            </section>

            <!-- 추천 섹션 -->
            <section id="recommendation" class="card tab-meal">
                <h2>다음 식사는 이게 어때요? 👩‍🍳</h2>
                <div id="recommendation-content">
                    <p>분석 중...</p>
                </div>
                <button id="speakBtn" class="btn-speak">🗣️ 말해줘!</button>
            </section>
        </main>
    </div>

    <!-- AI 로딩 오버레이 -->
    <div id="ai-loading" class="ai-overlay" style="display: none;">
        <div class="ai-loader-content">
            <div class="spinner"></div>
            <p>유나가 사진을 보고 있어요... ✨</p>
        </div>
    </div>
    <!-- 설정 모달 -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"
                style="padding: 20px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="font-size: 1.3rem; color: #333;">⚙️ 앱 설정</h3>
                <span class="close-modal" id="close-settings"
                    style="font-size: 2.4rem; font-weight: bold; cursor: pointer; color: #999; line-height: 1; display: inline-block; padding: 0 10px;">&times;</span>
            </div>
            <div class="modal-body">
                <div class="preference-section" style="margin-bottom: 20px;">
                    <h4
                        style="font-family: var(--font-heading); color: var(--primary-color); margin-bottom: 12px; font-size: 1.1rem;">
                        😋 음식 취향 설정
                    </h4>
                    <div class="pref-group" style="margin-bottom: 15px;">
                        <label style="display:block; margin-bottom:5px; font-weight:bold; color:#555;">좋아해요! ✨</label>
                        <div id="likes-tags" class="tag-container" style="margin-bottom:8px; min-height:30px;"></div>
                        <input type="text" id="like-input" class="input-premium" placeholder="좋아하는 음식 (엔터로 추가)">
                    </div>
                    <div class="pref-group">
                        <label style="display:block; margin-bottom:5px; font-weight:bold; color:#555;">싫어해요! 😖</label>
                        <div id="dislikes-tags" class="tag-container" style="margin-bottom:8px; min-height:30px;"></div>
                        <input type="text" id="dislike-input" class="input-premium" placeholder="싫어하는 음식 (엔터로 추가)">
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 20px; border-top: 1px dashed #eee; padding-top: 20px;">
                    <label>⚙️ 기저귀 정보 설정</label>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.8rem; color: #666;">낮 기저귀 (1팩당 개수)</label>
                            <input type="number" id="diaper-day-pack-input" class="input-premium" placeholder="예: 50">
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.8rem; color: #666;">밤 기저귀 (1팩당 개수)</label>
                            <input type="number" id="diaper-night-pack-input" class="input-premium" placeholder="예: 30">
                        </div>
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 20px; border-top: 1px dashed #eee; padding-top: 20px;">
                    <label>🔑 Gemini API Key</label>
                    <p style="font-size: 0.8rem; color: #666; margin-bottom: 8px;">
                        AI 식단 분석 기능을 위해 필요합니다.
                        <a href="https://aistudio.google.com/app/apikey" target="_blank"
                            style="color: var(--secondary-color); text-decoration: underline;">여기에서 무료로 발급</a> 받으실 수
                        있습니다.
                    </p>
                    <input type="password" id="gemini-api-key-input" class="input-premium" placeholder="API 키를 입력하세요">
                </div>

                <button id="save-settings" class="btn-premium-action">
                    <span>설정 저장하기</span>
                </button>
            </div>
        </div>
    </div>
    <div id="dev-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🦒 우리아기 성장 발달표</h2>
                <button class="close-btn" id="close-dev-modal">&times;</button>
            </div>
            <div id="dev-modal-body" class="modal-body">
                <!-- 개발 데이터가 여기에 동적으로 삽입됨 -->
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventory-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 350px;">
            <h3 class="modal-title">📦 기저귀 재고 관리</h3>

            <div style="margin-bottom: 20px;">
                <label style="display:block; margin-bottom:8px; font-weight:bold; color:#555;">종류 선택</label>
                <div class="toggle-group" style="display: flex; gap: 10px;">
                    <button id="modal-type-day" class="toggle-btn selected" onclick="selectInvType('day')"
                        style="flex: 1; padding: 12px; border-radius: 10px; border: 2px solid #0984e3; background: #0984e3; color: white; font-weight: bold;">
                        ☀️ 낮
                    </button>
                    <button id="modal-type-night" class="toggle-btn" onclick="selectInvType('night')"
                        style="flex: 1; padding: 12px; border-radius: 10px; border: 2px solid #dfe6e9; background: #fff; color: #b2bec3; font-weight: bold;">
                        🌙 밤
                    </button>
                </div>
                <input type="hidden" id="inv-selected-type" value="day">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display:block; margin-bottom:8px; font-weight:bold; color:#555;">작업 선택</label>
                <div class="toggle-group" style="display: flex; gap: 10px;">
                    <button id="modal-mode-pack" class="toggle-btn selected" onclick="selectInvMode('pack')"
                        style="flex: 1; padding: 12px; border-radius: 10px; border: 2px solid #6c5ce7; background: #6c5ce7; color: white; font-weight: bold;">
                        📦 팩 추가
                    </button>
                    <button id="modal-mode-unit" class="toggle-btn" onclick="selectInvMode('unit')"
                        style="flex: 1; padding: 12px; border-radius: 10px; border: 2px solid #dfe6e9; background: #fff; color: #b2bec3; font-weight: bold;">
                        🔢 낱개 조절
                    </button>
                </div>
                <input type="hidden" id="inv-selected-mode" value="pack">
            </div>

            <div style="margin-bottom: 25px;">
                <label id="inv-input-label" style="display:block; margin-bottom:8px; font-weight:bold; color:#555;">추가할
                    팩 수</label>
                <input type="number" id="inv-amount" placeholder="수량을 입력하세요"
                    style="width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; font-size: 1.1rem; text-align: center;">
                <p id="inv-help-text" style="font-size: 0.8rem; color: #888; margin-top: 5px; text-align: center;">
                    한 팩에 들어있는 개수만큼 추가됩니다.
                </p>
            </div>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeInventoryModal()">닫기</button>
                <button class="btn-confirm" onclick="submitInventory()">저장</button>
            </div>
        </div>
    </div>

    <!-- Time Edit Modal -->
    <div id="record-edit-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; border-radius: 25px; padding: 30px;">
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="font-size: 3rem; margin-bottom: 15px;">🕒</div>
                <h3 style="font-family: 'Jua', sans-serif; font-size: 1.6rem; color: #333; margin-bottom: 10px;">기록 시간
                    수정</h3>
                <p style="color: #888; font-size: 0.9rem;">활동이 발생한 정확한 시간을 선택해주세요.</p>
            </div>

            <div style="margin-bottom: 25px;">
                <label style="display:block; margin-bottom:10px; font-weight:bold; color:#555; font-size: 0.95rem;">수정할
                    시간</label>
                <input type="datetime-local" id="edit-record-datetime"
                    style="width: 100%; padding: 15px; border: 2px solid #f1f1f1; border-radius: 15px; font-size: 1.1rem; color: #333; outline: none; transition: border-color 0.3s; margin-bottom: 15px;">

                <div class="time-adjust-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                    <button type="button" onclick="adjustEditTime(-60)" class="btn-adjust-quick">-1h</button>
                    <button type="button" onclick="adjustEditTime(-10)" class="btn-adjust-quick">-10m</button>
                    <button type="button" onclick="adjustEditTime(-1)" class="btn-adjust-quick">-1m</button>
                    <button type="button" onclick="adjustEditTime(1)" class="btn-adjust-quick">+1m</button>
                    <button type="button" onclick="adjustEditTime(10)" class="btn-adjust-quick">+10m</button>
                    <button type="button" onclick="adjustEditTime(60)" class="btn-adjust-quick">+1h</button>
                </div>

                <input type="hidden" id="edit-record-id">
                <input type="hidden" id="edit-record-category">
            </div>

            <div style="display: flex; gap: 12px; margin-top: 10px;">
                <button onclick="closeEditModal()"
                    style="flex: 1; padding: 15px; border: none; border-radius: 15px; background: #f1f2f6; color: #57606f; font-weight: bold; cursor: pointer; transition: all 0.3s;">취소</button>
                <button onclick="submitEditTime()"
                    style="flex: 2; padding: 15px; border: none; border-radius: 15px; background: linear-gradient(135deg, #a29bfe, #6c5ce7); color: white; font-weight: bold; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(108, 92, 231, 0.2);">변경
                    저장</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>